{"swagger":"2.0","info":{"description":"API for payment processing in the bus booking system\nThis service handles payment transactions, refunds, and payment history.","title":"Payment Service API","contact":{"name":"API Support","email":"support@busbooking.com"},"license":{"name":"MIT","url":"https://opensource.org/licenses/MIT"},"version":"1.0"},"paths":{"/api/v1/transactions/payment-link":{"post":{"description":"Create a payment link via PayOS for a booking","consumes":["application/json"],"produces":["application/json"],"tags":["transactions"],"summary":"Create a payment link","parameters":[{"description":"Payment creation request","name":"transaction","in":"body","required":true,"schema":{"$ref":"#/definitions/bus-booking_payment-service_internal_model.CreatePaymentLinkRequest"}}],"responses":{"201":{"description":"Created","schema":{"allOf":[{"$ref":"#/definitions/ginext.Response"},{"type":"object","properties":{"data":{"$ref":"#/definitions/bus-booking_payment-service_internal_model.TransactionResponse"}}}]}},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/ginext.Response"}},"500":{"description":"Internal Server Error","schema":{"$ref":"#/definitions/ginext.Response"}}}}},"/api/v1/transactions/webhook":{"post":{"description":"Handle payment webhook notification from PayOS","consumes":["application/json"],"produces":["application/json"],"tags":["transactions"],"summary":"Handle PayOS webhook","parameters":[{"description":"Webhook payload","name":"webhook","in":"body","required":true,"schema":{"$ref":"#/definitions/bus-booking_payment-service_internal_model.PaymentWebhookData"}}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/ginext.Response"}},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/ginext.Response"}},"500":{"description":"Internal Server Error","schema":{"$ref":"#/definitions/ginext.Response"}}}}},"/api/v1/transactions/{id}":{"get":{"description":"Retrieve transaction details by transaction ID","consumes":["application/json"],"produces":["application/json"],"tags":["transactions"],"summary":"Get transaction by ID","parameters":[{"type":"string","description":"Transaction ID","name":"id","in":"path","required":true}],"responses":{"200":{"description":"OK","schema":{"allOf":[{"$ref":"#/definitions/ginext.Response"},{"type":"object","properties":{"data":{"$ref":"#/definitions/bus-booking_payment-service_internal_model.TransactionResponse"}}}]}},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/ginext.Response"}},"404":{"description":"Not Found","schema":{"$ref":"#/definitions/ginext.Response"}},"500":{"description":"Internal Server Error","schema":{"$ref":"#/definitions/ginext.Response"}}}}}},"definitions":{"bus-booking_payment-service_internal_model.CreatePaymentLinkRequest":{"type":"object","required":["amount","booking_id","currency","payment_method"],"properties":{"amount":{"type":"integer"},"booking_id":{"type":"string"},"currency":{"$ref":"#/definitions/bus-booking_payment-service_internal_model.Currency"},"description":{"type":"string"},"payment_method":{"$ref":"#/definitions/bus-booking_payment-service_internal_model.PaymentMethod"}}},"bus-booking_payment-service_internal_model.Currency":{"type":"string","enum":["VND"],"x-enum-varnames":["CurrencyVND"]},"bus-booking_payment-service_internal_model.PaymentMethod":{"type":"string","enum":["PAYOS"],"x-enum-varnames":["PaymentMethodPayOS"]},"bus-booking_payment-service_internal_model.PaymentWebhookData":{"type":"object","properties":{"code":{"type":"string"},"data":{"$ref":"#/definitions/bus-booking_payment-service_internal_model.PaymentWebhookDetails"},"desc":{"type":"string"},"signature":{"type":"string"},"success":{"type":"boolean"}}},"bus-booking_payment-service_internal_model.PaymentWebhookDetails":{"type":"object","properties":{"accountNumber":{"type":"string"},"amount":{"type":"integer"},"code":{"type":"string"},"counterAccountBankId":{"type":"string"},"counterAccountBankName":{"type":"string"},"counterAccountName":{"type":"string"},"counterAccountNumber":{"type":"string"},"currency":{"type":"string"},"desc":{"type":"string"},"description":{"type":"string"},"orderCode":{"type":"integer"},"paymentLinkId":{"type":"string"},"reference":{"type":"string"},"transactionDateTime":{"type":"string"},"virtualAccountName":{"type":"string"},"virtualAccountNumber":{"type":"string"}}},"bus-booking_payment-service_internal_model.TransactionResponse":{"type":"object","properties":{"amount":{"type":"integer"},"booking_id":{"type":"string"},"checkout_url":{"type":"string"},"created_at":{"type":"string"},"currency":{"$ref":"#/definitions/bus-booking_payment-service_internal_model.Currency"},"id":{"type":"string"},"order_code":{"type":"integer"},"payment_method":{"$ref":"#/definitions/bus-booking_payment-service_internal_model.PaymentMethod"},"qr_code":{"type":"string"},"status":{"$ref":"#/definitions/bus-booking_payment-service_internal_model.TransactionStatus"},"updated_at":{"type":"string"},"user_id":{"type":"string"}}},"bus-booking_payment-service_internal_model.TransactionStatus":{"type":"string","enum":["PENDING","CANCELLED","UNDERPAID","PAID","EXPIRED","PROCESSING","FAILED"],"x-enum-varnames":["TransactionStatusPending","TransactionStatusCancelled","TransactionStatusUnderpaid","TransactionStatusPaid","TransactionStatusExpired","TransactionStatusProcessing","TransactionStatusFailed"]},"ginext.ErrorBody":{"type":"object","properties":{"message":{"type":"string"}}},"ginext.MetaData":{"type":"object","properties":{"page":{"type":"integer"},"page_size":{"type":"integer"},"total":{"type":"integer"},"total_pages":{"type":"integer"}}},"ginext.Response":{"type":"object","properties":{"code":{"type":"integer"},"data":{},"error":{"$ref":"#/definitions/ginext.ErrorBody"},"header":{"$ref":"#/definitions/http.Header"},"message":{"type":"string"},"meta":{"$ref":"#/definitions/ginext.MetaData"}}},"http.Header":{"type":"object","additionalProperties":{"type":"array","items":{"type":"string"}}}},"securityDefinitions":{"BearerAuth":{"description":"Type \"Bearer\" followed by a space and JWT token.","type":"apiKey","name":"Authorization","in":"header"}}}