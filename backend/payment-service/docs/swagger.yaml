definitions:
  bus-booking_payment-service_internal_model.CreateTransactionRequest:
    properties:
      amount:
        type: number
      booking_id:
        type: string
      buyer_email:
        type: string
      buyer_name:
        type: string
      buyer_phone:
        type: string
      currency:
        type: string
      description:
        type: string
      payment_method:
        type: string
    required:
      - amount
      - booking_id
      - currency
      - payment_method
    type: object
  bus-booking_payment-service_internal_model.PaymentWebhookData:
    properties:
      code:
        type: string
      data:
        $ref: "#/definitions/bus-booking_payment-service_internal_model.PaymentWebhookDetails"
      desc:
        type: string
      signature:
        type: string
      success:
        type: boolean
    type: object
  bus-booking_payment-service_internal_model.PaymentWebhookDetails:
    properties:
      accountNumber:
        type: string
      amount:
        type: integer
      code:
        type: string
      counterAccountBankId:
        type: string
      counterAccountBankName:
        type: string
      counterAccountName:
        type: string
      counterAccountNumber:
        type: string
      currency:
        type: string
      desc:
        type: string
      description:
        type: string
      orderCode:
        type: integer
      paymentLinkId:
        type: string
      reference:
        type: string
      transactionDateTime:
        type: string
      virtualAccountName:
        type: string
      virtualAccountNumber:
        type: string
    type: object
  bus-booking_payment-service_internal_model.TransactionResponse:
    properties:
      amount:
        type: number
      booking_id:
        type: string
      checkout_url:
        type: string
      created_at:
        type: integer
      currency:
        type: string
      id:
        type: string
      order_code:
        type: integer
      payment_method:
        type: string
      qr_code:
        type: string
      status:
        type: string
      updated_at:
        type: integer
    type: object
  ginext.ErrorBody:
    properties:
      message:
        type: string
    type: object
  ginext.Response:
    properties:
      code:
        type: integer
      data: {}
      error:
        $ref: "#/definitions/ginext.ErrorBody"
      header:
        $ref: "#/definitions/http.Header"
      message:
        type: string
    type: object
  http.Header:
    additionalProperties:
      items:
        type: string
      type: array
    type: object
info:
  contact:
    email: support@busbooking.com
    name: API Support
  description: |-
    API for payment processing in the bus booking system
    This service handles payment transactions, refunds, and payment history.
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  title: Payment Service API
  version: "1.0"
paths:
  /api/v1/transactions/{order_code}:
    get:
      description: Retrieve transaction details by PayOS order code
      parameters:
        - description: Order code
          in: path
          name: order_code
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
              - $ref: "#/definitions/ginext.Response"
              - properties:
                  data:
                    $ref: "#/definitions/bus-booking_payment-service_internal_model.TransactionResponse"
                type: object
        "400":
          description: Bad Request
          schema:
            $ref: "#/definitions/ginext.Response"
        "404":
          description: Not Found
          schema:
            $ref: "#/definitions/ginext.Response"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ginext.Response"
      summary: Get transaction by order code
      tags:
        - transactions
  /api/v1/transactions/cancel:
    get:
      consumes:
        - application/json
      description: Handle cancel from PayOS payment page
      parameters:
        - description: Order code
          in: query
          name: orderCode
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: "#/definitions/ginext.Response"
        "400":
          description: Bad Request
          schema:
            $ref: "#/definitions/ginext.Response"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ginext.Response"
      summary: Handle payment cancellation
      tags:
        - transactions
  /api/v1/transactions/payment-link:
    post:
      consumes:
        - application/json
      description: Create a payment link via PayOS for a booking
      parameters:
        - description: Payment creation request
          in: body
          name: transaction
          required: true
          schema:
            $ref: "#/definitions/bus-booking_payment-service_internal_model.CreateTransactionRequest"
      produces:
        - application/json
      responses:
        "201":
          description: Created
          schema:
            allOf:
              - $ref: "#/definitions/ginext.Response"
              - properties:
                  data:
                    $ref: "#/definitions/bus-booking_payment-service_internal_model.TransactionResponse"
                type: object
        "400":
          description: Bad Request
          schema:
            $ref: "#/definitions/ginext.Response"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ginext.Response"
      summary: Create a payment link
      tags:
        - transactions
  /api/v1/transactions/return:
    get:
      consumes:
        - application/json
      description: Handle return from PayOS payment page (success)
      parameters:
        - description: Order code
          in: query
          name: orderCode
          required: true
          type: integer
        - description: Payment status
          in: query
          name: status
          type: string
      produces:
        - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: "#/definitions/ginext.Response"
        "400":
          description: Bad Request
          schema:
            $ref: "#/definitions/ginext.Response"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ginext.Response"
      summary: Handle payment return
      tags:
        - transactions
  /api/v1/transactions/webhook:
    post:
      consumes:
        - application/json
      description: Handle payment webhook notification from PayOS
      parameters:
        - description: Webhook payload
          in: body
          name: webhook
          required: true
          schema:
            $ref: "#/definitions/bus-booking_payment-service_internal_model.PaymentWebhookData"
      produces:
        - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: "#/definitions/ginext.Response"
        "400":
          description: Bad Request
          schema:
            $ref: "#/definitions/ginext.Response"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/ginext.Response"
      summary: Handle PayOS webhook
      tags:
        - transactions
  /transactions:
    post:
      consumes:
        - application/json
      description: Create a new transaction for a booking
      parameters:
        - description: Transaction creation request
          in: body
          name: transaction
          required: true
          schema:
            $ref: "#/definitions/bus-booking_payment-service_internal_model.CreateTransactionRequest"
      produces:
        - application/json
      responses:
        "201":
          description: Created
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Invalid request
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Create a new transaction
      tags:
        - transactions
securityDefinitions:
  BearerAuth:
    description: Type "Bearer" followed by a space and JWT token.
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
